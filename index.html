<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Varejão Online - Frutas e Verduras Frescas</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="landing-page">
    <!-- Landing Page -->
    <div id="landing-section">
        <nav class="landing-nav">
            <div class="nav-brand">
                <i class="fas fa-shopping-basket"></i>
                <span>Varejão <span class="accent">Online</span></span>
            </div>
            <div class="nav-actions">
                <button class="btn-outline" onclick="showLogin()">Entrar</button>
                <button class="btn-primary" onclick="showRegister()">Cadastrar</button>
            </div>
        </nav>

        <section class="hero">
            <div class="hero-content">
                <h1 class="hero-title">
                    Frutas e Verduras <span class="gradient-text">Fresquinhas</span> na Sua Casa
                </h1>
                <p class="hero-subtitle">
                    Qualidade, frescor e economia em um só lugar. Faça seu pedido online e receba no conforto da sua casa!
                </p>
                <div class="hero-buttons">
                    <button class="btn-large btn-primary" onclick="showRegister()">
                        <i class="fas fa-rocket"></i> Começar Agora
                    </button>
                    <button class="btn-large btn-outline" onclick="showLogin()">
                        <i class="fas fa-sign-in-alt"></i> Já Tenho Conta
                    </button>
                </div>
            </div>
            <div class="hero-image">
                <div class="floating-card">
                    <i class="fas fa-leaf"></i>
                    <h3>100% Frescos</h3>
                    <p>Produtos selecionados diariamente</p>
                </div>
                <div class="floating-card delay-1">
                    <i class="fas fa-truck"></i>
                    <h3>Entrega Rápida</h3>
                    <p>Receba em até 24 horas</p>
                </div>
                <div class="floating-card delay-2">
                    <i class="fas fa-tag"></i>
                    <h3>Preços Justos</h3>
                    <p>Economia garantida</p>
                </div>
            </div>
        </section>

        <section class="features">
            <div class="container">
                <h2 class="section-title">Por que escolher o Varejão Online?</h2>
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-apple-alt"></i>
                        </div>
                        <h3>Produtos Frescos</h3>
                        <p>Selecionamos os melhores produtos todos os dias para garantir qualidade e frescor.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <h3>Economia de Tempo</h3>
                        <p>Faça suas compras em minutos, sem sair de casa. Simples, rápido e prático.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <h3>Compra Segura</h3>
                        <p>Seus dados estão protegidos e suas compras são garantidas.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-headset"></i>
                        </div>
                        <h3>Suporte Dedicado</h3>
                        <p>Nossa equipe está sempre pronta para ajudar você.</p>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Modal de Login -->
    <div id="login-modal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModals()">
                <i class="fas fa-times"></i>
            </button>
            <div class="modal-header">
                <i class="fas fa-sign-in-alt modal-icon"></i>
                <h2>Bem-vindo de Volta!</h2>
                <p>Entre com suas credenciais para acessar sua conta</p>
            </div>
            <form id="login-form" onsubmit="fazerLogin(event)">
                <div class="form-group">
                    <label for="login-email">
                        <i class="fas fa-envelope"></i> E-mail
                    </label>
                    <input type="email" id="login-email" placeholder="seu@email.com" required>
                </div>
                <div class="form-group">
                    <label for="login-pass">
                        <i class="fas fa-lock"></i> Senha
                    </label>
                    <input type="password" id="login-pass" placeholder="••••••••" required>
                </div>
                <button type="submit" class="btn-submit">
                    <i class="fas fa-sign-in-alt"></i> Entrar
                </button>
            </form>
            <div class="modal-footer">
                <p>Não tem uma conta? <a href="#" onclick="switchToRegister()">Cadastre-se aqui</a></p>
            </div>
        </div>
    </div>

    <!-- Modal de Cadastro -->
    <div id="register-modal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModals()">
                <i class="fas fa-times"></i>
            </button>
            <div class="modal-header">
                <i class="fas fa-user-plus modal-icon"></i>
                <h2>Criar Nova Conta</h2>
                <p>Preencha os dados abaixo para começar</p>
            </div>
            <form id="register-form" onsubmit="fazerCadastro(event)">
                <div class="form-group">
                    <label for="reg-name">
                        <i class="fas fa-user"></i> Nome Completo
                    </label>
                    <input type="text" id="reg-name" placeholder="João Silva" required>
                </div>
                <div class="form-group">
                    <label for="reg-email">
                        <i class="fas fa-envelope"></i> E-mail
                    </label>
                    <input type="email" id="reg-email" placeholder="seu@email.com" required>
                </div>
                <div class="form-group">
                    <label for="reg-pass">
                        <i class="fas fa-lock"></i> Senha
                    </label>
                    <input type="password" id="reg-pass" placeholder="Mínimo 6 caracteres" required minlength="6">
                    <small class="form-hint">A senha deve ter pelo menos 6 caracteres</small>
                </div>
                <button type="submit" class="btn-submit">
                    <i class="fas fa-rocket"></i> Criar Conta
                </button>
            </form>
            <div class="modal-footer">
                <p>Já tem uma conta? <a href="#" onclick="switchToLogin()">Faça login</a></p>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toast-container"></div>

    <script>
        const API_URL = 'https://varejao-backend-shpn.onrender.com';

        // Gerenciamento de Modais
        function showLogin() {
            document.getElementById('login-modal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function showRegister() {
            document.getElementById('register-modal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeModals() {
            document.getElementById('login-modal').classList.remove('active');
            document.getElementById('register-modal').classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function switchToRegister() {
            closeModals();
            setTimeout(showRegister, 300);
        }

        function switchToLogin() {
            closeModals();
            setTimeout(showLogin, 300);
        }

        // Sistema de Toast
        function showToast(message, type = 'success') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            
            const icon = type === 'success' ? 'fa-check-circle' : 
                        type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle';
            
            toast.innerHTML = `
                <i class="fas ${icon}"></i>
                <span>${message}</span>
            `;
            
            container.appendChild(toast);
            
            setTimeout(() => toast.classList.add('show'), 10);
            
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // Login
        async function fazerLogin(event) {
            event.preventDefault();
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-pass').value;
            const submitBtn = event.target.querySelector('button[type="submit"]');
            
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Entrando...';

            try {
                const response = await fetch(`${API_URL}/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password })
                });

                const data = await response.json();
                
                if (response.ok) {
                    localStorage.setItem('usuario', data.user.name);
                    localStorage.setItem('userEmail', data.user.email);
                    showToast('Login realizado com sucesso!', 'success');
                    setTimeout(() => window.location.href = 'dashboard.html', 1000);
                } else {
                    showToast(data.message || 'E-mail ou senha incorretos', 'error');
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = '<i class="fas fa-sign-in-alt"></i> Entrar';
                }
            } catch (error) {
                showToast('Erro ao conectar com o servidor', 'error');
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<i class="fas fa-sign-in-alt"></i> Entrar';
            }
        }

        // Cadastro
        async function fazerCadastro(event) {
            event.preventDefault();
            const name = document.getElementById('reg-name').value;
            const email = document.getElementById('reg-email').value;
            const password = document.getElementById('reg-pass').value;
            const submitBtn = event.target.querySelector('button[type="submit"]');

            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Criando conta...';

            try {
                const response = await fetch(`${API_URL}/register`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name, email, password })
                });

                const data = await response.json();

                if (response.ok) {
                    showToast('Conta criada com sucesso! Faça login para continuar.', 'success');
                    setTimeout(() => switchToLogin(), 1500);
                } else {
                    showToast(data.message || 'Erro ao criar conta', 'error');
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = '<i class="fas fa-rocket"></i> Criar Conta';
                }
            } catch (error) {
                showToast('Erro ao conectar com o servidor', 'error');
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<i class="fas fa-rocket"></i> Criar Conta';
            }
        }

        // Fechar modal ao clicar fora
        window.onclick = function(event) {
            const loginModal = document.getElementById('login-modal');
            const registerModal = document.getElementById('register-modal');
            if (event.target === loginModal || event.target === registerModal) {
                closeModals();
            }
        }
    </script>
</body>
</html>
